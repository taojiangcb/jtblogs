---
title: Webpack çš„ç”Ÿå‘½å‘¨æœŸ
catalog: true
tags:
  - Webpack
date: 2025-04-10 18:33:59
subtitle:
header-img:
---


è¿™ä¸ªé—®é¢˜é—®å¾—éå¸¸ä¸“ä¸šï¼Webpack çš„æ‰§è¡Œè¿‡ç¨‹æ˜¯ä¸€ä¸ª**å¤šé˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸç³»ç»Ÿ**ï¼Œå¯ä»¥åˆ†ä¸ºè‹¥å¹²ä¸ªé˜¶æ®µï¼ˆphasesï¼‰å’Œå‘¨æœŸï¼ˆcyclesï¼‰ã€‚ç†è§£è¿™äº›æ‰§è¡Œé˜¶æ®µï¼Œæœ‰åŠ©äºä½ æ›´å¥½åœ°å†™æ’ä»¶ã€è°ƒè¯•æ„å»ºé—®é¢˜ã€ä¼˜åŒ–æ€§èƒ½ã€‚

---

## ğŸš€ ä¸€å¥è¯æ€»ç»“

> **Webpack çš„æ‰§è¡Œå‘¨æœŸç”±å¤šä¸ª Hook ç”Ÿå‘½å‘¨æœŸé˜¶æ®µç»„æˆï¼Œæ¯ä¸ªé˜¶æ®µè´Ÿè´£æ„å»ºæµç¨‹ä¸­çš„ä¸åŒä»»åŠ¡ã€‚**

---

## ğŸ§± Webpack æ‰§è¡Œå‘¨æœŸå›¾ï¼ˆç®€åŒ–ç‰ˆï¼‰

```
åˆå§‹åŒ–é˜¶æ®µï¼ˆInitializationï¼‰
â”‚
â”œâ”€â”€ ç¯å¢ƒå‡†å¤‡ï¼šinitialize â†’ environment â†’ afterEnvironment
â”‚
â”œâ”€â”€ åŠ è½½é…ç½®ä¸æ’ä»¶ï¼šentryOption â†’ afterPlugins
â”‚
ç¼–è¯‘å‡†å¤‡é˜¶æ®µï¼ˆCompiler Setupï¼‰
â”‚
â”œâ”€â”€ run / watchRun
â”‚
ç¼–è¯‘æ„å»ºé˜¶æ®µï¼ˆCompilationï¼‰
â”‚
â”œâ”€â”€ compile
â”‚   â”œâ”€â”€ thisCompilation
â”‚   â”œâ”€â”€ compilation
â”‚   â”œâ”€â”€ make ï¼ˆåˆ›å»ºä¾èµ–å›¾ï¼‰
â”‚   â”œâ”€â”€ buildModule â†’ finishModules
â”‚   â””â”€â”€ sealï¼ˆä¼˜åŒ– chunk å’Œ moduleï¼‰
â”‚
èµ„æºè¾“å‡ºé˜¶æ®µï¼ˆEmit Assetsï¼‰
â”‚
â”œâ”€â”€ emit
â”‚   â””â”€â”€ afterEmit
â”‚
ç»“æŸé˜¶æ®µï¼ˆDoneï¼‰
â”‚
â”œâ”€â”€ done / failed
â””â”€â”€ watchClose / shutdown
```

---

## ğŸ§© å„é˜¶æ®µè¯¦ç»†è¯´æ˜

### 1ï¸âƒ£ åˆå§‹åŒ–é˜¶æ®µï¼ˆInitialization Phaseï¼‰

| ç”Ÿå‘½å‘¨æœŸ | è¯´æ˜ |
|----------|------|
| `initialize` | Webpack CLI åˆ›å»º compiler æ—¶è§¦å‘ |
| `environment` | è®¾ç½® loader è§£æã€plugin åŠ è½½å‰ |
| `afterEnvironment` | ç¯å¢ƒå˜é‡å¤„ç†å®Œæˆ |
| `entryOption` | è¯»å–å¹¶å¤„ç† entry é…ç½® |
| `afterPlugins` | æ‰€æœ‰æ’ä»¶å·²è¢«æŒ‚è½½ |

ğŸ“Œ æ’ä»¶å¸¸åœ¨è¿™ä¸€é˜¶æ®µæŒ‚é’© `apply(compiler)`ã€‚

---

### 2ï¸âƒ£ ç¼–è¯‘å‡†å¤‡é˜¶æ®µï¼ˆCompiler Phaseï¼‰

| ç”Ÿå‘½å‘¨æœŸ | è¯´æ˜ |
|----------|------|
| `beforeRun` | ç¼–è¯‘å¼€å§‹å‰è°ƒç”¨ï¼ˆä»…é¦–æ¬¡ï¼‰ |
| `run` | æ­£å¸¸æ„å»ºæ—¶è§¦å‘ |
| `watchRun` | ç›‘å¬æ¨¡å¼ä¸‹ï¼Œæ–‡ä»¶å˜åŒ–é‡æ–°ç¼–è¯‘æ—¶è§¦å‘ |

> ç¼–è¯‘å¯åŠ¨æ—¶çš„å…¥å£ç‚¹ã€‚

---

### 3ï¸âƒ£ ç¼–è¯‘æ„å»ºé˜¶æ®µï¼ˆCompilation Phaseï¼‰

è¿™æ˜¯ Webpack çš„æ ¸å¿ƒé˜¶æ®µï¼

| ç”Ÿå‘½å‘¨æœŸ | è¯´æ˜ |
|----------|------|
| `compile` | æ„å»ºè¿‡ç¨‹å¼€å§‹ï¼Œå‡†å¤‡ Compilation å¯¹è±¡ |
| `thisCompilation` | åˆ›å»º Compilation å®ä¾‹ |
| `compilation` | Compilation å®ä¾‹åˆ›å»ºåç«‹å³è§¦å‘ |
| `make` | æ„å»ºæ¨¡å—å›¾å¼€å§‹ï¼Œä¾èµ–åˆ†æ |
| `buildModule` | å¼€å§‹æ„å»ºæ¨¡å—ï¼ˆä¼šå¤šæ¬¡è°ƒç”¨ï¼‰ |
| `seal` | å®Œæˆä¾èµ–å›¾åï¼Œå‡†å¤‡ç”Ÿæˆ chunkã€ä¼˜åŒ– |

ğŸ“Œ æ’ä»¶å¯åœ¨è¿™é‡Œä¿®æ”¹ moduleã€chunkã€assetã€ä¾èµ–å›¾ç»“æ„ç­‰ã€‚

---

### 4ï¸âƒ£ è¾“å‡ºèµ„æºé˜¶æ®µï¼ˆEmit Phaseï¼‰

| ç”Ÿå‘½å‘¨æœŸ | è¯´æ˜ |
|----------|------|
| `emit` | å¼€å§‹å†™æ–‡ä»¶ä¹‹å‰ï¼ˆå¯æ”¹è¾“å‡ºå†…å®¹ï¼‰ |
| `afterEmit` | å†™å®Œæ–‡ä»¶ä¹‹å |

ğŸ“Œ å¯ç”¨äºç”Ÿæˆé¢å¤–æ–‡ä»¶ã€ä¿®æ”¹è¾“å‡ºå†…å®¹ã€è®°å½•æ—¥å¿—ã€‚

---

### 5ï¸âƒ£ ç»“æŸé˜¶æ®µï¼ˆDone Phaseï¼‰

| ç”Ÿå‘½å‘¨æœŸ | è¯´æ˜ |
|----------|------|
| `done` | ç¼–è¯‘æˆåŠŸå®Œæˆ |
| `failed` | ç¼–è¯‘å¤±è´¥ |
| `watchClose` | ç›‘å¬æ¨¡å¼ä¸‹å…³é—­ |
| `shutdown` | Webpack å®Œæ•´é€€å‡ºå‰ï¼ˆç”¨äºæ¸…ç†èµ„æºï¼‰ |

---

## ğŸ§ª æ¯ä¸ªå‘¨æœŸå†…éƒ¨éƒ½å¯èƒ½è§¦å‘å¾ˆå¤šäº‹ä»¶

æ¯”å¦‚ï¼š

```js
compiler.hooks.compilation.tap('MyPlugin', (compilation) => {
  compilation.hooks.optimizeModules.tap('MyPlugin', () => {
    console.log('æ¨¡å—ä¼˜åŒ–ä¸­');
  });

  compilation.hooks.processAssets.tap('MyPlugin', () => {
    console.log('è¾“å‡ºèµ„æºå¤„ç†');
  });
});
```

---

## ğŸ” ä¸€ä¸ªå®Œæ•´å‘¨æœŸå¯¹ç…§è¡¨

| é˜¶æ®µ | Hookï¼ˆå¸¸ç”¨ï¼‰ |
|------|--------------|
| åˆå§‹åŒ– | `initialize`, `environment`, `entryOption`, `afterPlugins` |
| ç¼–è¯‘å‡†å¤‡ | `beforeRun`, `run`, `watchRun` |
| ç¼–è¯‘æ„å»º | `compile`, `compilation`, `make`, `buildModule`, `seal` |
| è¾“å‡ºèµ„æº | `emit`, `afterEmit`, `processAssets` |
| ç¼–è¯‘ç»“æŸ | `done`, `failed`, `watchClose`, `shutdown` |

---

## ğŸ¯ æ€»ç»“

Webpack æ˜¯äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œæ ¸å¿ƒæµç¨‹æ˜¯ï¼š

1. **åˆ›å»º Compiler å®ä¾‹**
2. **ç”Ÿæˆ Compilation å¯¹è±¡**
3. **æ„å»ºä¾èµ–å›¾**
4. **ç”Ÿæˆ chunk ä¸ asset**
5. **è¾“å‡ºèµ„æºåˆ°ç£ç›˜**
6. **è§¦å‘æœ€ç»ˆå®Œæˆäº‹ä»¶**

---